(function(a,b){"object"==typeof exports&&"undefined"!=typeof module?module.exports=b():"function"==typeof define&&define.amd?define(b):a.KadenceAccordion=b()})(this,function(){"use strict";function a(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function b(a,b){for(let c=0;c<b.length;c++){const d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}function c(a,c,d){return c&&b(a.prototype,c),d&&b(a,d),a}function d(){return d=Object.assign||function(a){for(let b=1;b<arguments.length;b++){const c=arguments[b];for(const b in c)Object.prototype.hasOwnProperty.call(c,b)&&(a[b]=c[b])}return a},d.apply(this,arguments)}function e(a){return f(a)||g(a)||h()}function f(a){if(Array.isArray(a)){for(var b=0,c=Array(a.length);b<a.length;b++)c[b]=a[b];return c}}function g(a){if(Symbol.iterator in Object(a)||"[object Arguments]"===Object.prototype.toString.call(a))return Array.from(a)}function h(){throw new TypeError("Invalid attempt to spread non-iterable instance")}Array.from||(Array.from=function(){const a=Object.prototype.toString,b=function(b){return"function"==typeof b||"[object Function]"===a.call(b)},c=function(a){const b=+a;return isNaN(b)?0:0!=b&&isFinite(b)?(0<b?1:-1)*Math.floor(Math.abs(b)):b},d=Math.pow(2,53)-1,e=function(a){const b=c(a);return Math.min(Math.max(b,0),d)};return function(a){const c=this,d=Object(a);if(null==a)throw new TypeError("Array.from requires an array-like object - not null or undefined");const f=1<arguments.length?arguments[1]:void 0;let g;if("undefined"!=typeof f){if(!b(f))throw new TypeError("Array.from: when provided, the second argument must be a function");2<arguments.length&&(g=arguments[2])}const h=e(d.length),i=b(c)?Object(new c(h)):Array(h);let j,l=0;for(;l<h;)j=d[l],i[l]=f?"undefined"==typeof g?f(j,l):f.call(g,j,l):j,l+=1;return i.length=h,i}}()),function(a){const b=a.body||a.documentElement,c=b.style;let d="",e="";""==c.WebkitAnimation&&(d="-webkit-"),""==c.MozAnimation&&(d="-moz-"),""==c.OAnimation&&(d="-o-"),""==c.WebkitTransition&&(e="-webkit-"),""==c.MozTransition&&(e="-moz-"),""==c.OTransition&&(e="-o-"),Object.defineProperty(Object.prototype,"onCSSAnimationEnd",{value:function(a){const b=function c(b){a(),b.target.removeEventListener(b.type,c)};return this.addEventListener("webkitAnimationEnd",b),this.addEventListener("mozAnimationEnd",b),this.addEventListener("oAnimationEnd",b),this.addEventListener("oanimationend",b),this.addEventListener("animationend",b),(""!=d||"animation"in c)&&"0s"!=getComputedStyle(this)[d+"animation-duration"]||a(),this},enumerable:!1,writable:!0}),Object.defineProperty(Object.prototype,"onCSSTransitionEnd",{value:function(a){const b=function c(b){a(),b.target.removeEventListener(b.type,c)};return this.addEventListener("webkitTransitionEnd",b),this.addEventListener("mozTransitionEnd",b),this.addEventListener("oTransitionEnd",b),this.addEventListener("transitionend",b),this.addEventListener("transitionend",b),(""!=e||"transition"in c)&&"0s"!=getComputedStyle(this)[e+"transition-duration"]||a(),this},enumerable:!1,writable:!0})}(document,window,0);const i=function(){function b(c,f){const g=this;a(this,b);const h="string"==typeof c?document.querySelector(c):c;if(null==h)return;this.settings=d({},{headerClass:".kt-blocks-accordion-header",panelClass:".kt-accordion-panel",panelInnerClass:".kt-accordion-panel-inner",hiddenClass:"kt-accordion-panel-hidden",activeClass:"kt-accordion-panel-active",get hidenClass(){return this.hiddenClass},initializedClass:"kt-accordion-initialized",get initalisedClass(){return this.initializedClass},headerDataAttr:"data-kt-accordion-header-id",openMultiplePanels:!1,openHeadersOnLoad:[],headerOpenLabel:"",headerCloseLabel:"",roles:!0},f),this.container=h;const i=Array.from(this.container.children),j=[];Array.from(i).forEach(function(a){Array.from(a.children).forEach(function(a){j.push(a)})});const k=j.filter(function(a){return!a.classList.contains(g.settings.panelClass.substr(1))});this.headers=k.reduce(function(b,c){let d,f=Array.from(c.children).filter(function(a){return a.classList.contains(g.settings.headerClass.substr(1))});return!f.length&&c.children[0]&&c.children[0].children&&c.children[0].children.length&&(f=Array.from(c.children[0].children).filter(function(a){return a.classList.contains(g.settings.headerClass.substr(1))})),b=(d=[]).concat.apply(d,e(b).concat([f])),b},[]),this.panels=j.filter(function(a){return a.classList.contains(g.settings.panelClass.substr(1))}),this.toggleEl=void 0===this.settings.toggleEl?this.headers:Array.from(this.container.querySelectorAll(this.settings.toggleEl)),this.states=[].map.call(this.headers,function(){return{state:"closed"}}),this.ids=[].map.call(this.headers,function(){return{id:Math.floor(1e6*Math.random()+1)}}),this.toggling=!1,this.container?this.init():console.log("Something is wrong with you markup...")}return c(b,[{key:"init",value:function(){this._setupAttributes(),this._initalState(),this.calculateAllPanelsHeight(),this._insertDataAttrs(),this._addListeners(),this._finishInitialization()}},{key:"_setRole",value:function(a,b){("boolean"==typeof this.settings.roles&&this.settings.roles||void 0!==this.settings.roles[a]&&!1!==this.settings.roles[a])&&b.setAttribute("role",a)}},{key:"_initalState",value:function(){const a=this.settings.openHeadersOnLoad;this.headers.forEach(function(a){a.setAttribute("aria-expanded",!1)}),a.length&&(this.toggling=!0,this._openHeadersOnLoad(a)),this._renderDom()}},{key:"_insertDataAttrs",value:function(){const a=this;this.headers.forEach(function(b,c){b.setAttribute(a.settings.headerDataAttr,c)})}},{key:"_finishInitialization",value:function(){this.container.classList.add(this.settings.initializedClass),this._setRole("presentation",this.container),this.container.dispatchEvent(new Event("initialized"))}},{key:"_addListeners",value:function(){const a=this;this.headers.forEach(function(b,c){b.addEventListener("click",function(){a.handleClick(b,c)}),b.addEventListener("keydown",function(b){const d=b.which.toString(),e=b.ctrlKey&&d.match(/33|34/);if(d.match(/38|40/)||e){const e=d.match(/34|40/)?1:-1,f=a.headers.length;a.headers[(c+f+e)%f].focus(),b.preventDefault()}else d.match(/35|36/)&&("36"===d?a.headers[0].focus():"35"===d?a.headers[a.headers.length-1].focus():void 0,b.preventDefault())}),b.addEventListener("startOpen",function(){a.handleClick(b,c,!0)})})}},{key:"handleClick",value:function(a,b,c){c||(c=!1);const d=this,e=this.settings.headerClass.substr(1);if(a.classList.contains(e)&&!1===this.toggling)this.toggling=!0,this.setState(b),this._renderDom();else if(c)var f=setInterval(function(){!1===d.toggling&&(d.toggling=!0,d.setState(b),d._renderDom(),clearInterval(f))},50)}},{key:"setState",value:function(a){const b=this,c=this.getState();this.settings.openMultiplePanels||c.filter(function(b,c){c!=a&&(b.state="closed")}),c.filter(function(c,d){if(d==a){const a=b.toggleState(c.state);return c.state=a}})}},{key:"_renderDom",value:function(){const a=this;this.states.filter(function(b,c){"open"===b.state&&a.open(c,!1)}),this.states.filter(function(b,c){"closed"===b.state&&a.close(c,!1)})}},{key:"open",value:function(a){const b=!(1<arguments.length&&void 0!==arguments[1])||arguments[1];b&&this.setState(a),this.togglePanel("open",a)}},{key:"close",value:function(a){const b=!(1<arguments.length&&void 0!==arguments[1])||arguments[1];b&&this.setState(a),this.togglePanel("closed",a)}},{key:"openAll",value:function(){const a=this;this.headers.forEach(function(b,c){a.togglePanel("open",c)})}},{key:"closeAll",value:function(){const a=this;this.headers.forEach(function(b,c){a.togglePanel("closed",c)})}},{key:"togglePanel",value:function(a,b){const c=this;if(void 0!==a&&void 0!==b)if("closed"===a){const a=this.headers[b],d=this.panels[b];if(!d.classList.contains(this.settings.hiddenClass)){d.setAttribute("data-panel-height",d.scrollHeight+"px"),d.style.height=d.scrollHeight+"px",d.offsetHeight,d.style.height="",d.classList.add("kt-panel-is-collapsing"),d.classList.remove(this.settings.activeClass),a.classList.remove(this.settings.activeClass),a.setAttribute("aria-expanded",!1);const b=1e3*parseFloat(getComputedStyle(d).transitionDuration);setTimeout(function(){return d.classList.add(c.settings.hiddenClass),d.classList.remove("kt-panel-is-collapsing"),window.AOS&&"function"==typeof AOS.refresh&&AOS.refresh(),c.toggling=!1},b)}}else if("open"===a){const a=this.headers[b],d=this.panels[b];if(!d.classList.contains(this.settings.activeClass)){d.classList.remove(this.settings.hiddenClass),d.style.height=0,d.offsetHeight,d.classList.add("kt-panel-is-expanding"),d.style.height=d.scrollHeight<parseInt(d.getAttribute("data-panel-height"))?parseInt(d.getAttribute("data-panel-height"))+"px":d.scrollHeight+"px",d.offsetHeight,a.classList.add(this.settings.activeClass),a.setAttribute("aria-expanded",!0),window.dispatchEvent(new Event("resize"));const b=1e3*parseFloat(getComputedStyle(d).transitionDuration);setTimeout(function(){return d.classList.add(c.settings.activeClass),d.style.height="",d.classList.remove("kt-panel-is-expanding"),window.AOS&&"function"==typeof AOS.refresh&&AOS.refresh(),c.toggling=!1},b)}}}},{key:"getState",value:function(){const a=this,b=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[];if(b.length&&Array.isArray(b)){const c=b.map(function(b){return a.states[b]});return c}return this.states}},{key:"toggleState",value:function(a){if(void 0!==a)return"closed"===a?"open":"closed"}},{key:"_openHeadersOnLoad",value:function(){const a=this,b=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[];if(b.length&&Array.isArray(b)){const c=b.filter(function(a){return null!=a});c.forEach(function(b){a.setState(b)})}}},{key:"_setupAttributes",value:function(){this._setupHeaders(),this._setupPanels(),this._insertDataAttrs()}},{key:"_setPanelHeight",value:function(){this.calculateAllPanelsHeight()}},{key:"calculatePanelHeight",value:function(a){const b=a.querySelector(this.settings.panelInnerClass),c=b.getBoundingClientRect();return a.setAttribute("data-panel-height","".concat(c.height,"px"))}},{key:"calculateAllPanelsHeight",value:function(){const a=this;this.panels.forEach(function(b){a.calculatePanelHeight(b)})}},{key:"_setupHeaders",value:function(){const a=this;this.headers.forEach(function(b,c){b.setAttribute("id","kt-accordion-header-".concat(a.ids[c].id)),b.setAttribute("aria-controls","kt-accordion-panel-".concat(a.ids[c].id))})}},{key:"_setupPanels",value:function(){const a=this;this.panels.forEach(function(b,c){b.setAttribute("id","kt-accordion-panel-".concat(a.ids[c].id)),b.setAttribute("aria-labelledby","kt-accordion-header-".concat(a.ids[c].id)),(!0===a.settings.roles||!1!==a.settings.roles.region)&&a._setRole("region",b)})}}]),b}();return i}),function(){"use strict";let a=!1;window.KadenceBlocksAccordion={scrollToElement(a){window.scrollBy({top:Math.floor(a.getBoundingClientRect().top),left:0,behavior:"smooth"})},anchor(b){if(""!=window.location.hash){const c=location.hash.substring(1);if(!/^[A-z0-9_-]+$/.test(c))return;if(b.type&&"initialized"===b.type&&a)return;a=!0;const d=document.getElementById(c);if(d&&d.classList.contains("wp-block-kadence-pane")){const a=document.querySelectorAll("[id=\""+c+"\"] .kt-blocks-accordion-header")[0];a.classList.contains("kt-accordion-panel-active")||(b.type&&"initialized"===b.type?window.setTimeout(function(){a.dispatchEvent(new Event("startOpen"))},50):(a.dispatchEvent(new Event("startOpen")),setTimeout(()=>{window.KadenceBlocksAccordion.scrollToElement(d)},600)))}}},init(){const a=document.querySelectorAll(".kt-accordion-inner-wrap"),c=Array.from(a);for(let a=0,b=c.length;a<b;a++){const b=c[a].getAttribute("data-allow-multiple-open"),d=c[a].getAttribute("data-start-open");let e=parseInt(d);if("none"!==d)for(let d=0,b=c[a].children.length;d<b;d++)if(c[a].children[d].classList.contains("kt-accordion-pane-"+parseInt(1+e))){e=d;break}c[a].addEventListener("initialized",window.KadenceBlocksAccordion.anchor,!1),new KadenceAccordion(c[a],{openHeadersOnLoad:"none"===d?[]:[parseInt(e)],headerClass:".kt-blocks-accordion-header",panelClass:".kt-accordion-panel",panelInnerClass:".kt-accordion-panel-inner",hiddenClass:"kt-accordion-panel-hidden",activeClass:"kt-accordion-panel-active",initializedClass:"kt-accordion-initialized",headerDataAttr:"data-kt-accordion-header-id",openMultiplePanels:!("true"!==b),roles:{presentation:!1,region:!0}})}window.addEventListener("hashchange",window.KadenceBlocksAccordion.anchor,!1),window.addEventListener("kb-query-loaded",()=>{window.KadenceBlocksAccordion.init()})}},"loading"===document.readyState?document.addEventListener("DOMContentLoaded",window.KadenceBlocksAccordion.init):window.KadenceBlocksAccordion.init()}();